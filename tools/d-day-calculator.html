<!DOCTYPE html>
<html lang="ko">
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9J3H9RR9ZD"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-9J3H9RR9ZD');
    </script>

    <script>
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
            document.documentElement.setAttribute('data-theme', 'dark');
        }
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D-Day 계산기 (기념일, 시험, 디데이) - 이지툴즈</title>
    <link rel="stylesheet" href="../css/style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root { --primary: #F43F5E; }
        .date-picker-area { background: #FFF1F2; padding: 20px; border-radius: 12px; margin-bottom: 20px; border: 1px solid #FECDD3; }
        .result-card { display: flex; justify-content: space-between; align-items: center; padding: 15px; border-bottom: 1px solid #eee; }
        .result-card:last-child { border-bottom: none; }
        .d-day-label { font-weight: bold; color: #555; }
        .d-day-date { color: var(--primary); font-weight: bold; }
        .main-result { text-align: center; font-size: 2.5rem; font-weight: 800; color: var(--primary); margin: 20px 0; }
        .sub-info { text-align: center; color: #888; font-size: 0.9rem; margin-bottom: 20px; }
    </style>
    <link rel="manifest" href="../manifest.json">

    <link rel="icon" type="image/png" sizes="32x32" href="../images/icon-192.png">
    <link rel="apple-touch-icon" sizes="180x180" href="../images/icon-192.png">

</head>
<body class="tool-page">
    <div class="container">
    <button class="tool-theme-btn" onclick="toggleThemeTool()">
        <i class="fas fa-moon"></i>
    </button>

        <h1><i class="fas fa-calendar-check"></i> D-Day 계산기</h1>
        
        <div class="date-picker-area">
            <div class="input-group">
                <label>기준 날짜 (사귄 날, 시험일 등)</label>
                <input type="date" id="baseDate" onchange="calcDday()">
            </div>
            <div class="input-group" style="display:flex; gap:10px; align-items:center; margin-bottom:0;">
                <input type="checkbox" id="includeToday" checked onchange="calcDday()" style="width:auto;">
                <label for="includeToday" style="margin:0; font-weight:normal;">기준일 1일로 포함 (커플 기념일 등)</label>
            </div>
        </div>

        <div class="result-box" id="result" style="display:none; padding:10px;">
            <div class="sub-info">기준일로부터 오늘은</div>
            <div class="main-result" id="todayCount">D+0</div>
            
            <hr style="border:0; border-top:1px dashed #ddd; margin:20px 0;">

            <div class="result-card">
                <span class="d-day-label">100일</span>
                <span class="d-day-date" id="date100">-</span>
            </div>
            <div class="result-card">
                <span class="d-day-label">200일</span>
                <span class="d-day-date" id="date200">-</span>
            </div>
            <div class="result-card">
                <span class="d-day-label">1주년 (365일)</span>
                <span class="d-day-date" id="date1year">-</span>
            </div>
            <div class="result-card">
                <span class="d-day-label">1000일</span>
                <span class="d-day-date" id="date1000">-</span>
            </div>
        </div>

        <div class="info-section">
            <h2>D-Day 계산, '1일' 포함 여부가 헷갈린다면?</h2>
            <p>기념일을 챙길 때 가장 헷갈리는 것이 바로 <strong>"오늘을 1일로 칠까, 말까?"</strong>입니다. 계산 방식에 따라 날짜가 하루씩 차이가 나기 때문에 주의해야 합니다.</p>

            <h3>1. 커플 기념일 vs 시험 D-Day</h3>
            <ul>
                <li><strong>커플 기념일 (만난 날 = 1일):</strong> 보통 연인 사이에서는 사귀기 시작한 그날을 1일로 칩니다. 따라서 100일 기념일은 만난 날로부터 99일 뒤가 됩니다. (본 계산기의 '기준일 1일 포함' 체크)</li>
                <li><strong>시험/수능 D-Day (남은 기간):</strong> 시험 당일은 포함하지 않고, 오늘부터 며칠이 '남았는지'를 셉니다. 내일이 시험이라면 D-1이 됩니다. (체크 해제)</li>
                <li><strong>만 나이/행정 (0일 시작):</strong> 태어난 날을 0일로 보고 만 하루가 지나야 1일이 되는 방식입니다.</li>
            </ul>

            <h3>2. 기념일 계산 꿀팁</h3>
            <p>100일, 200일 단위로 챙기는 것은 한국의 독특한 기념일 문화입니다. 서양에서는 주로 1년 단위(Anniversary)를 중요하게 생각합니다. 최근에는 1000일이나 10주년 같은 굵직한 날짜 위주로 챙기는 실속파 커플들도 늘고 있습니다. 중요한 날짜를 미리 계산해서 달력에 표시해두면 센스 있는 연인이 될 수 있습니다.</p>
        </div>

        <a href="../index.html" class="back-btn">← 메인으로 돌아가기</a>
    </div>

    <script>
        // 오늘 날짜로 초기화
        document.getElementById('baseDate').valueAsDate = new Date();

        function calcDday() {
            const baseStr = document.getElementById('baseDate').value;
            if(!baseStr) return;

            const base = new Date(baseStr);
            const today = new Date();
            // 시간 초기화 (날짜만 비교)
            base.setHours(0,0,0,0);
            today.setHours(0,0,0,0);

            const isInclude = document.getElementById('includeToday').checked;
            const diffTime = today - base;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

            // 메인 D-day 표시
            let dCount = "";
            if(diffDays > 0) dCount = `D+${isInclude ? diffDays + 1 : diffDays}`;
            else if(diffDays < 0) dCount = `D${diffDays}`; // D-10 형태
            else dCount = isInclude ? "D+1 (오늘)" : "D-Day (오늘)";
            
            document.getElementById('todayCount').innerText = dCount;

            // 기념일 계산 함수
            const calcAnniversary = (days) => {
                const target = new Date(base);
                // 1일 포함이면 (days-1)일 더함, 아니면 days일 더함
                const add = isInclude ? days - 1 : days;
                target.setDate(target.getDate() + add);
                const week = ['일','월','화','수','목','금','토'];
                return `${target.getFullYear()}.${target.getMonth()+1}.${target.getDate()} (${week[target.getDay()]})`;
            };

            document.getElementById('date100').innerText = calcAnniversary(100);
            document.getElementById('date200').innerText = calcAnniversary(200);
            document.getElementById('date1year').innerText = calcAnniversary(365); // 1주년
            document.getElementById('date1000').innerText = calcAnniversary(1000);

            document.getElementById('result').style.display = 'block';
        }
        
        // 로딩 시 자동 실행
        window.onload = calcDday;
    </script>

    <script>
        // 다크모드 토글 기능
        function toggleThemeTool() {
            const current = document.documentElement.getAttribute('data-theme');
            if (current === 'dark') {
                document.documentElement.setAttribute('data-theme', 'light');
                localStorage.setItem('theme', 'light');
            } else {
                document.documentElement.setAttribute('data-theme', 'dark');
                localStorage.setItem('theme', 'dark');
            }
        }
    </script>

    <script>
        // 기존 alert() 함수를 가로채서 토스트로 보여주는 마법의 코드
        window.alert = function(message) {
            showToast(message);
        };

        function showToast(message) {
            // 컨테이너가 없으면 생성
            let container = document.getElementById('toast-container');
            if (!container) {
                container = document.createElement('div');
                container.id = 'toast-container';
                document.body.appendChild(container);
            }

            // 메시지 박스 생성
            const toast = document.createElement('div');
            toast.className = 'toast-message';
            // 아이콘과 메시지 결합
            toast.innerHTML = `<i class="fas fa-check-circle"></i> <span>${message}</span>`;

            container.appendChild(toast);

            // 애니메이션 시작
            requestAnimationFrame(() => {
                setTimeout(() => { toast.classList.add('show'); }, 10);
            });

            // 2.5초 후 제거
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => { 
                    if(container.contains(toast)) container.removeChild(toast);
                }, 300);
            }, 2500);
        }
    </script>
</body>


</html>